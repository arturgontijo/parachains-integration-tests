---
settings:
  chains:
    relay_chain: &relay_chain
      wsPort: 9900
    assets_parachain: &assets_parachain
      wsPort: 9910
      paraId: &ap_id 1000
    trappist_parachain: &trappist_parachain
      wsPort: 9920
      paraId: &tp_id 2000
  variables:
    common:
      xcm_verison: &xcm_version '3'
      require_weight_at_most: &weight_at_most 1000000000
    chains:
      relay_chain:
        signer: &rc_signer //Alice
        assets_parachain_destination: &ap_dest { v3: { 0, interior: { x1: { parachain: *ap_id }}}}
      trappist_parachain:
        signer: &tp_signer //Alice
  decodedCalls:
    ap_force_xcm_version:
      chain: *assets_parachain
      pallet: polkadotXcm
      call: forceXcmVersion
      args: [
        { # location
          parents: 1,
          interior: Here
        },
        *xcm_version # xcmVersion
      ]

tests:
  - name: Initialize Chains
    its:
      - name: XCM supported versions between chains
        actions:
          - extrinsics: # Relay Chain sets supported version for Assset Parachain
            - chain: *relay_chain
              sudo: true
              signer: *rc_signer
              pallet: xcmPallet
              call: forceXcmVersion
              args: [
                { # location
                  parents: 0,
                  interior: {
                    X1: {
                      Parachain: *ap_id
                    }
                  }
                },
                *xcm_version # xcmVersion
              ]
              events:
                - name: sudo.Sudid
                  attribute:
                    type: Result<Null, SpRuntimeDispatchError>
                    value: Ok
                - name: xcmPallet.SupportedVersionChanged
                  attribute:
                    type: u32
                    value: *xcm_version
          - extrinsics: # Relay Chain sets supported version for Trappist Parachain
            - chain: *relay_chain
              sudo: true
              signer: *rc_signer
              pallet: xcmPallet
              call: forceXcmVersion
              args: [
                { # location
                  parents: 0,
                  interior: {
                    X1: {
                      Parachain: *tp_id
                    }
                  }
                },
                *xcm_version # xcmVersion
              ]
              events:
                - name: sudo.Sudid
                  attribute:
                    type: Result<Null, SpRuntimeDispatchError>
                    value: Ok
                - name: xcmPallet.SupportedVersionChanged
                  attribute:
                    type: u32
                    value: *xcm_version
