---
settings:
  chains:
    relay_chain: &relay_chain
      wsPort: 9900
    reserve_parachain: &reserve_parachain
      wsPort: 9910
      paraId: &rp_id 1000
    trappist_parachain: &trappist_parachain
      wsPort: 9920
      paraId: &tp_id 2000
    base_parachain: &base_parachain
      wsPort: 9930
      paraId: &bp_id 3000
  variables:
    common:
      amount_to_send: &amount_to_send 10000000000000
      require_weight_at_most: &weight_at_most 1000000000
    chains:
      relay_chain:
        signer: &rc_signer //Alice
        wallet: &rc_wallet HNZata7iMYWmk5RvZRTiAsSDhV8366zq2YGb3tLH5Upf74F #Alice
        trappist_parachain_dest_routed: &tp_dest_routed { v1: { parents: 1, interior: { x1: { parachain: *tp_id } }}}
        ksm: &rc_ksm { concrete: { 0, interior: { here: true }}}
        ksm_fungible: &rc_ksm_fungible { id: *rc_ksm, fun: { fungible: *amount_to_send }}
      reserve_parachain:
        signer: &rp_signer //Alice
        wallet: &rp_wallet HNZata7iMYWmk5RvZRTiAsSDhV8366zq2YGb3tLH5Upf74F
        bob_signer: &rp_bob_signer //Bob
        bob_wallet: &rp_bob_wallet FoQJpPyadYccjavVdTWxpxU7rUEaYhfLCPwXgkfD6Zat9QP
        assets_parachain_destination: &rp_dest { v2: { 0, interior: { x1: { parachain: *rp_id }}}}
        assets_parachain_account: &rp_acc '0xd43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d'
        assets_parachain_beneficiary: &rp_benf { v2: { parents: 0, interior: { x1: { accountId32: { network: null, id: *rp_acc }}}}}  
      trappist_parachain:
        signer: &tp_signer //Alice
        wallet: &tp_wallet 5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY
        bob_wallet: &tp_bob_wallet 5FHneW46xGXgs5mUiveU4sbTyGBzmstUspZC92UhjJM694ty
        asset_id: &trappist_asset_id 100 # different from reserve_asset_id, so we can test pallet-assets-registry
        asset_min_balance: &trappist_assets_min_balance 1
        sovereign_account: &tp_sovereign_sibl FBeL7EAeUroLWXW1yfKboiqTqVfbRBcsUKd6QqVf4kGBySS
        bob_account: &tp_bob_acc '0x8eaf04151687736326c9fea17e25fc5287613693c912909cb226aa4794f26a48'
      base_parachain:
        signer: &base_signer //Alice
        wallet: &base_wallet 5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY
        bob_wallet: &base_bob_wallet 5FHneW46xGXgs5mUiveU4sbTyGBzmstUspZC92UhjJM694ty
        asset_id: &base_asset_id 1
        asset_min_balance: &base_assets_min_balance 1
        bob_account: &tp_bob_acc '0x8eaf04151687736326c9fea17e25fc5287613693c912909cb226aa4794f26a48'

tests:
  - name: HRMP
    describes:
      - name: xcmPallet.limitedTeleportAssets (Asset) | Relay Chain -> Reserve Parachain
        its:
          - name: Should teleport native assets from the Relay Chain to the Reserve Parachain
            actions:
              - extrinsics:
                - chain: *relay_chain
                  signer: *rc_signer
                  pallet: xcmPallet
                  call: limitedTeleportAssets
                  args: [
                    *rp_dest, # destination
                    *rp_benf, # beneficiary
                    { v2: [ *rc_ksm_fungible ] }, # assets
                    0, # feeAssetItem
                    { unlimited: true } # weightLimit
                  ]
                  events:
                    - name: polkadotXcm.Attempted
                      attributes:
                        - type: XcmV2TraitsOutcome
                          xcmOutcome: Complete
                    - name: dmpQueue.ExecutedDownward
                      chain: *reserve_parachain
              - queries:
                  balance_rc_sender_after:
                    chain: *relay_chain
                    pallet: system
                    call: account
                    args: [ *rc_wallet ]
                  balance_ap_receiver_after:
                    chain: *reserve_parachain
                    pallet: system
                    call: account
                    args: [ *rp_wallet ]